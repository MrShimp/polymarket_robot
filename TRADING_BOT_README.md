# 交易机器人使用指南

## 概述

我为你创建了两个交易机器人，根据你的需求实现自动化交易策略：

### 交易策略参数
- **入场条件**: 75%概率以上
- **止盈条件**: 90%概率 或 3个点盈利
- **止损条件**: 55%概率
- **高概率等待**: 超过86%概率时等待330秒
- **监控频率**: 每10秒检查一次

## 机器人版本

### 1. 完整版交易机器人 (`trading_bot.py`)
功能完整的交易机器人，支持多线程监控、详细日志记录。

**使用方法:**
```bash
python trading_bot.py
```

**交互式操作:**
1. 输入市场ID
2. 选择方向 (yes/no)  
3. 输入交易金额
4. 确认启动

**特点:**
- 完整的日志记录
- 多线程监控
- 详细的交易记录
- 信号处理 (Ctrl+C安全退出)
- 持仓状态跟踪

### 2. 快速交易机器人 (`quick_trading_bot.py`)
简化版本，命令行直接启动。

**使用方法:**
```bash
python quick_trading_bot.py <market_id> <yes|no> [amount]
```

**示例:**
```bash
# 市场123456，选择yes，投入20 USDC
python quick_trading_bot.py 123456 yes 20

# 市场789012，选择no，投入默认金额(10 USDC)
python quick_trading_bot.py 789012 no
```

**特点:**
- 命令行直接启动
- 简化的日志输出
- 快速部署
- 适合脚本化调用

## 交易逻辑详解

### 入场逻辑
1. 监控价格，计算概率 (价格 × 100)
2. 当概率 ≥ 75% 时触发入场信号
3. 如果概率 ≥ 86%，等待330秒后再入场
4. 执行市价买单

### 出场逻辑 (满足任一条件即出场)
1. **概率止盈**: 概率 ≥ 90%
2. **点数止盈**: 盈利 ≥ 3个点 (价格上涨0.03)
3. **概率止损**: 概率 ≤ 55%

### 监控流程
```
开始监控 → 获取价格 → 计算概率 → 判断条件 → 执行交易 → 记录结果
    ↑                                                           ↓
    ←←←←←←←←←←←←← 等待10秒 ←←←←←←←←←←←←←←←←←←←←←←←←←←←←←←←←←
```

## 配置要求

### 1. API配置
确保 `config/sys_config.json` 中配置了正确的Polymarket API信息：
```json
{
  "polymarket": {
    "private_key": "0x...",
    "api_key": "...",
    "api_secret": "...",
    "passphrase": "...",
    "funder_address": "0x..."
  }
}
```

### 2. 依赖安装
```bash
pip install py-clob-client requests
```

## 文件结构

```
├── trading_bot.py              # 完整版交易机器人
├── quick_trading_bot.py        # 快速交易机器人
├── trading/
│   ├── polymarket_clob_client.py  # CLOB客户端封装
│   └── order_manager.py           # 订单管理器
├── data/
│   ├── trading_logs/           # 交易日志
│   ├── trades/                 # 交易记录
│   └── quick_trades/           # 快速交易记录
└── config/
    └── sys_config.json         # 系统配置
```

## 安全提示

1. **测试环境**: 建议先在测试网测试
2. **资金管理**: 设置合理的交易金额
3. **监控**: 保持对机器人运行状态的监控
4. **备份**: 定期备份配置和日志文件
5. **网络**: 确保网络连接稳定

## 日志和记录

### 交易日志
- 位置: `data/trading_logs/`
- 包含: 入场/出场信号、价格变化、错误信息

### 交易记录
- 位置: `data/trades/` 或 `data/quick_trades/`
- 格式: JSON
- 包含: 完整的交易信息和盈亏数据

## 常见问题

### Q: 机器人不入场怎么办？
A: 检查概率是否达到75%，查看日志了解具体原因。

### Q: 如何停止机器人？
A: 按 Ctrl+C 安全停止，机器人会完成当前操作后退出。

### Q: 如何修改交易参数？
A: 编辑机器人文件中的参数变量，或创建配置文件。

### Q: 余额不足怎么办？
A: 确保钱包有足够的USDC余额，检查API配置是否正确。

## 示例使用场景

### 场景1: 长期监控
```bash
# 启动完整版机器人，交互式配置
python trading_bot.py
```

### 场景2: 快速交易
```bash
# 直接启动，适合脚本化
python quick_trading_bot.py 123456 yes 15
```

### 场景3: 批量交易
```bash
# 可以写脚本批量启动多个市场
for market in 123456 789012 345678; do
    python quick_trading_bot.py $market yes 10 &
done
```

## 技术支持

如需修改交易策略参数或添加新功能，可以：
1. 修改机器人文件中的参数常量
2. 添加新的交易条件逻辑
3. 扩展日志和记录功能
4. 集成更多的风险管理功能

---

**注意**: 交易有风险，请谨慎使用自动化交易工具，建议先小额测试。